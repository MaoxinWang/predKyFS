function [FS,sigma_FS] = FS_model(c_gh,tanPhi,tanBeta,D,ru,kh)

% Created by Mao-Xin Wang (dr.maoxin.wang@gmail.com or wangmx@whu.edu.cn)
% December 2023
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT
%
%   c_gh         = c/gama/H (scalar or matrix)
%                 (where c is soil cohesion, kPa; gama is soil unit weight, kN/m3;
%                  H is slope height, m)
%   tanPhi       = tangent of soil friction angle (scalar or matrix)
%   tanBeta      = tangent of slope angle (scalar or matrix)
%   D            = slope depth ratio (scalar or matrix)
%   ru           = tangent of slope angle (scalar or matrix)
%   kh           = seismic coefficient in horizontal direction (scalar or matrix)
%   Note: the above inputs must be in the same matrix dimension
%
% OUTPUT
%
%   FS           = factor of safety
%   sigma_FS     = standard deviation of FS
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Range values of inputted parameters
X_min = [0.0017 	0.0875 	0.1763 	1.0000 	0.0000 	0.0000];
X_max = [1.1111 	1.7321 	2.7475 	3.5000 	0.5000 	0.5000];

%% specify model coefficients
w1 = [
    -0.1477 	-0.0290 	0.0947 	0.1882 	0.1983 	-0.1650 	-2.1293 	0.4726 	-0.8468 	-0.1607 	-0.5624 	-0.0598 	-0.3141 	0.3216 	1.9776 	-0.6093 	13.3615 	-1.6558 	0.3260 	-0.7502 	0.0298 	0.1944 	0.5795 	-0.4866 	1.7672 	-0.0412 	-4.4843 	0.3321 	0.1988 	-0.6977 	-6.8515 	0.3792 	5.4482 	0.4209 	0.0598 	3.4815 	4.1934 	0.7815 	-7.6907 	21.9958 	4.2130 	-1.2423 	1.7717 	-1.9334 	0.3012 	-0.2306
    -0.1101 	0.1115 	0.3601 	-0.1964 	-0.0254 	-1.2029 	-3.6623 	-0.1005 	0.3283 	0.6785 	0.3502 	0.3653 	0.3558 	-1.2543 	-0.8636 	-0.0849 	-0.3202 	1.6590 	0.1596 	0.7044 	0.0816 	-0.2658 	0.6911 	0.5557 	0.1232 	0.0227 	0.3645 	-0.3872 	0.0905 	0.4243 	-0.0817 	0.3375 	-0.2478 	-0.2157 	0.1418 	-0.4055 	-0.2169 	-0.4360 	-0.0791 	0.4655 	-0.3343 	0.0510 	0.6855 	0.0700 	2.2462 	0.0651
    0.7536 	-0.0244 	1.2898 	-3.1085 	-2.4302 	0.0360 	0.0887 	2.0311 	-0.1390 	0.0957 	-0.0614 	-0.0478 	0.0652 	0.3423 	-0.1408 	4.9096 	0.0246 	0.0395 	-0.0793 	6.0965 	0.3941 	-0.5762 	0.9363 	-0.4042 	-0.7574 	-0.0014 	-0.4580 	-0.4128 	0.1057 	-0.6333 	0.1063 	-0.3902 	-0.1267 	-0.2075 	0.0814 	-0.9139 	-0.0967 	-0.2818 	-0.1130 	0.0862 	-0.7017 	-0.4789 	0.0979 	-1.1454 	0.0028 	-2.9082
    1.1515 	-0.0007 	0.0062 	-4.5759 	0.0084 	0.0297 	-0.0086 	-0.0037 	-0.0164 	0.4499 	0.3230 	-0.0041 	1.9236 	0.0017 	0.0104 	0.0025 	-0.0373 	-0.0022 	0.0005 	0.0326 	0.0030 	-0.0014 	0.0027 	-0.0146 	0.0053 	-0.8192 	0.0008 	0.0057 	-0.0260 	-0.0011 	0.3288 	0.0003 	0.0031 	-0.0015 	0.0803 	0.0000 	-0.1957 	-0.0064 	0.0046 	-0.0017 	-0.0040 	0.0014 	0.0093 	0.0018 	-0.0279 	-0.0066
    0.0180 	-0.0463 	0.0906 	0.0421 	0.0702 	0.0154 	0.0832 	0.1092 	-0.1225 	-0.0993 	-0.1299 	0.5500 	-0.0679 	0.1349 	0.0837 	-0.0474 	0.0219 	-0.2970 	-0.1396 	-0.1848 	-1.3097 	-0.5640 	0.2314 	-0.1503 	-0.2596 	0.0187 	-0.3979 	0.1299 	-0.0140 	-0.1155 	0.0026 	0.1179 	-0.0717 	-0.2919 	0.0015 	-0.6948 	0.0215 	0.0381 	0.0586 	0.0065 	0.7159 	-0.1222 	0.0387 	0.1941 	0.1624 	-0.0123
    0.6278 	-0.1545 	-0.0260 	-0.1635 	0.3135 	0.2403 	0.1659 	-0.0281 	-0.3805 	0.0888 	-0.2218 	-0.0444 	0.0232 	0.0319 	0.5671 	0.0682 	-0.0475 	-0.1833 	-0.0304 	0.3605 	-0.0987 	0.0538 	0.0457 	0.0360 	0.0160 	-0.4284 	-0.0179 	0.0518 	-0.8700 	0.0506 	0.2026 	-0.0833 	-0.0294 	-0.3663 	-1.3594 	-0.1212 	-0.0515 	0.7608 	0.2150 	-0.1070 	-0.1544 	0.2612 	0.0646 	0.0773 	0.0427 	-0.2051
    ];
w2 = [
    -0.0221 	0.0263 	1.0115 	-0.0168 	-0.5735 	-0.0167 	0.3518 	-0.4311 	0.0088 	-0.8976 	0.0304 	-1.3437 	0.0120 	-0.0065 	-0.0327 	-0.0160 	-0.0725 	0.0222 	-0.1715 	-1.1948 	-0.0129 	-0.1470 	-0.0506 	-0.0432 	0.0064 	-0.0084 	0.0404 	0.4075 	-8.3003 	-0.7944 	0.0554 	-0.0123 	0.0090 	1.1599 	-0.0269 	-0.0488 	0.0793 	0.1453 	0.0265 	-0.0048 	-8.3588 	0.0470 	-0.0613 	-0.0410 	0.0011 	0.3942
    0.6408 	-0.0455 	0.0823 	1.2594 	4.0581 	-1.7199 	0.6178 	0.0368 	-1.7162 	-0.6500 	0.2977 	-0.1339 	2.0499 	-0.3302 	-0.0631 	0.5335 	-0.4046 	2.8196 	0.7070 	-0.6318 	-0.2860 	-0.1634 	-0.9884 	-0.0065 	-0.0952 	0.3719 	0.5958 	0.3798 	1.0404 	-0.9495 	-1.4873 	0.6872 	1.7737 	0.3109 	-0.5052 	-3.4514 	0.5872 	1.8461 	0.1654 	1.4054 	1.0946 	1.8647 	-1.0455 	-0.6840 	-0.0722 	0.4263
    0.0025 	0.2498 	-0.3115 	-0.4584 	0.3857 	-0.0781 	0.0984 	0.4036 	0.3537 	1.1191 	-0.1845 	0.1945 	0.3243 	0.1947 	0.0510 	0.0296 	0.7530 	-0.3929 	1.9564 	0.6673 	0.0473 	-0.1221 	-0.1590 	-0.1034 	-0.0813 	-0.0466 	1.0001 	-0.4814 	1.3156 	0.0761 	0.4470 	-0.0817 	0.2694 	-0.4591 	0.3123 	-0.2292 	-0.2526 	-0.3681 	-0.2162 	0.2808 	1.3264 	-0.3550 	1.6437 	-0.9692 	-0.0750 	-0.3181
    -0.0132 	-0.1615 	-0.9300 	-0.0011 	0.5286 	-0.0211 	2.5912 	-0.9767 	0.0032 	0.9720 	0.0280 	-0.8478 	0.0252 	-0.0704 	-0.0717 	-0.0544 	-0.1062 	0.0311 	-0.1074 	0.7533 	0.0480 	-0.2174 	-0.3523 	-0.1072 	0.0258 	-0.0647 	-0.0832 	0.2230 	0.8443 	-0.6858 	0.1267 	-0.0368 	0.0112 	-0.8936 	-0.0218 	-0.2493 	0.6458 	-0.0804 	0.0055 	0.0017 	0.8498 	0.0893 	-0.0186 	0.0727 	-0.0163 	2.6238
    0.0706 	0.1371 	0.1325 	0.1308 	-0.2515 	0.0337 	-2.4249 	-0.4418 	-0.1916 	-1.8308 	-0.0844 	-0.1006 	-0.7882 	-0.0030 	0.0073 	0.0334 	0.0604 	0.4074 	1.9914 	-0.7488 	-0.1126 	-0.4163 	-0.0640 	1.5047 	0.0005 	0.1005 	-0.0846 	0.9507 	2.0262 	0.2403 	0.1583 	0.0237 	-0.9598 	0.4277 	0.0349 	2.9203 	1.0473 	0.1378 	0.0224 	0.0196 	2.0365 	0.0682 	-1.4956 	0.0824 	0.0613 	-2.3721
    0.0340 	-0.0735 	-0.7483 	-0.4481 	0.6813 	-0.0509 	-1.4535 	1.0011 	1.0113 	-0.0471 	0.4291 	0.8003 	-1.3528 	0.3614 	-0.2095 	-0.2251 	2.0059 	-0.3539 	1.1643 	0.3862 	0.3859 	0.2985 	1.1615 	1.2017 	-0.1756 	-0.4841 	2.5270 	-0.0843 	1.3526 	-0.7816 	-1.0891 	0.2973 	-1.1539 	-0.5010 	-0.3530 	6.4113 	-0.3030 	0.4207 	-0.1787 	-1.4419 	1.3345 	1.4082 	-3.3149 	-2.5830 	0.0550 	-1.4297
    0.9885 	-0.7671 	-1.4267 	-0.1941 	-1.2294 	-0.9015 	1.5699 	-0.6009 	-0.0104 	-1.6429 	-0.6061 	1.1737 	-0.7476 	-0.0959 	-0.2439 	0.3318 	1.1258 	0.1929 	-0.4597 	1.4088 	-0.0262 	-0.9868 	0.1821 	-0.2748 	-0.3024 	-0.4308 	-1.3055 	0.7495 	5.7189 	-1.2404 	0.1419 	0.1339 	-0.8940 	-1.4013 	0.5557 	3.9819 	-0.0443 	-1.5192 	-0.3934 	-0.6599 	5.7373 	-1.7393 	-0.3701 	1.3234 	0.2999 	1.6200
    0.2387 	-0.1762 	-0.1966 	-0.7015 	0.0851 	-0.1148 	-3.2444 	-0.3488 	-0.1483 	-0.7131 	-0.5413 	0.1835 	1.2420 	0.1600 	-0.2129 	-0.1040 	-0.3717 	-0.0197 	-0.1104 	0.1989 	-0.0133 	-0.6556 	-0.1030 	-0.0483 	-0.0090 	-0.0120 	-0.1860 	0.2349 	0.9404 	0.3430 	0.3531 	0.0432 	1.1927 	-0.2544 	0.5907 	-6.2815 	0.6179 	-0.0628 	0.1118 	0.1440 	0.9473 	-0.1692 	2.1908 	0.2153 	-0.0244 	-3.3234
    0.6095 	0.2190 	0.8309 	1.3486 	-0.8659 	-0.8558 	-0.1574 	0.8962 	-1.2427 	-1.1887 	-0.3169 	-0.8176 	-0.4198 	-0.0077 	0.0349 	0.2743 	1.0303 	0.4915 	-2.4637 	-0.7955 	0.4908 	-0.3713 	0.2285 	-1.2516 	-0.1834 	-0.2445 	-0.1472 	0.1135 	-2.4677 	-0.1287 	0.7608 	0.0892 	-0.5697 	0.7626 	0.1615 	3.7063 	0.7238 	0.4087 	-0.1443 	-0.0716 	-2.4646 	0.8081 	0.8303 	0.2863 	0.0329 	-0.2306
    -0.0025 	-0.1432 	0.5547 	0.0809 	1.4442 	-0.0119 	1.6432 	0.6289 	0.0201 	0.1574 	-0.0094 	0.2595 	-0.0637 	0.2669 	-0.0396 	0.0013 	0.1285 	0.0991 	0.1006 	-0.8472 	-0.1396 	-0.0329 	0.0098 	-0.0083 	-0.0819 	-0.0266 	-0.1275 	0.3042 	-2.9062 	1.3624 	0.0096 	0.1813 	-0.0655 	0.6331 	0.0015 	-0.0264 	-0.0822 	0.8761 	0.0374 	-0.0428 	-2.9199 	1.3937 	0.2057 	0.1325 	0.0278 	1.6481
    0.0200 	0.0131 	-1.1017 	-0.0017 	0.4065 	-0.0152 	-1.9392 	-3.2892 	-0.1065 	0.0623 	-0.0872 	0.2977 	0.1408 	0.0246 	0.0155 	-0.0941 	-0.1773 	-0.3751 	-0.4229 	1.4996 	-0.6366 	0.7371 	0.0996 	-0.4167 	0.1768 	0.1122 	0.2439 	-0.1572 	2.9326 	0.9537 	-0.8175 	-0.0042 	0.1168 	-1.2179 	0.0823 	-0.1591 	0.4211 	-0.4712 	0.1416 	0.1637 	2.9383 	-0.8641 	0.5101 	-0.2290 	-0.0581 	-1.8189
    0.3741 	-0.1496 	-0.6330 	-0.0821 	1.2689 	-0.3275 	0.6689 	0.4240 	-0.6055 	0.2562 	-0.7944 	1.0159 	0.8725 	-0.0104 	-0.0287 	0.1109 	-0.7829 	-0.3086 	-2.2537 	0.5720 	0.0046 	-0.4607 	0.1721 	-1.6309 	0.0384 	0.1929 	-0.3737 	-0.1587 	2.0674 	0.3503 	0.3094 	-0.3393 	0.6733 	-0.6244 	0.9184 	-1.6373 	-0.0562 	-0.3309 	-0.2608 	0.2771 	2.0738 	-0.4065 	2.7931 	0.3284 	-0.0839 	0.6168
    -0.0055 	0.1754 	-1.2643 	-0.0122 	0.7525 	0.0317 	-0.2299 	-0.2152 	-0.0088 	0.4196 	0.0145 	0.3207 	-0.0293 	-0.1900 	-0.0365 	-0.0047 	-0.1254 	0.1264 	-0.0988 	1.6709 	-0.0971 	-0.2580 	-0.4505 	-0.0153 	0.0768 	-0.0493 	-0.1290 	0.9186 	5.5098 	-0.6239 	0.1795 	-0.0400 	-0.0235 	-1.5084 	-0.0116 	0.0113 	0.1126 	-0.2838 	-0.0148 	0.0010 	5.5403 	0.0603 	-0.0392 	0.1208 	0.0029 	-0.1455
    0.9403 	0.3329 	-0.0715 	-1.6114 	0.8155 	-0.7097 	0.6736 	-0.4429 	-0.2347 	-0.1084 	-0.9535 	0.2386 	-2.3327 	0.0304 	0.4272 	0.1707 	-0.3588 	-0.0545 	3.9558 	0.1642 	0.0646 	0.6760 	-0.2295 	-1.3411 	-0.0861 	0.3159 	-0.8604 	-0.3704 	1.0152 	0.5700 	-0.8338 	-0.5917 	-2.4044 	-0.1413 	0.8855 	1.3441 	0.0798 	-0.1083 	-0.5187 	-0.1822 	1.0272 	-0.2022 	0.7832 	0.8365 	-0.0296 	0.7198
    0.2627 	-0.2901 	-0.4803 	0.1068 	-0.6861 	-0.1247 	0.6095 	-0.4892 	0.2149 	0.1293 	-0.0938 	0.5265 	-0.1796 	0.0309 	0.0955 	0.0455 	0.6702 	0.1977 	-0.3487 	0.4307 	-0.0736 	0.2431 	0.0028 	-0.0410 	-0.0179 	0.0646 	0.4578 	0.2598 	1.9337 	0.0308 	-0.2849 	0.3046 	-0.2429 	-0.4915 	0.0364 	1.6642 	-0.1789 	-0.6805 	-0.0161 	-0.1911 	1.9331 	-1.2133 	0.6526 	-0.3741 	0.0545 	0.6186
    -0.0579 	-0.0354 	0.0886 	0.0481 	0.0450 	0.0867 	-1.3055 	0.0516 	-0.0331 	-1.2778 	0.0506 	0.0414 	1.3939 	-0.1092 	-0.0099 	0.0479 	0.3015 	-0.3605 	0.1488 	-0.2968 	-0.0936 	-0.1464 	-0.0761 	-0.6864 	0.0417 	-0.0085 	0.0095 	-0.3302 	0.2043 	-0.0522 	0.1074 	-0.0005 	1.2605 	0.1814 	-0.0134 	-4.8127 	0.9167 	0.0104 	0.0176 	-0.0083 	0.2106 	0.0086 	-0.0629 	-0.0169 	0.0051 	-1.2975
    0.1265 	-0.2549 	-0.1327 	-0.9607 	2.3913 	-0.1030 	-0.1415 	0.2964 	-0.3040 	0.7379 	-0.4249 	0.3827 	0.2832 	0.1625 	0.3421 	-0.1522 	-0.2347 	0.0161 	1.9541 	0.1500 	0.0064 	1.6068 	0.0869 	-0.3434 	0.0619 	0.0364 	-0.2757 	0.0204 	0.4789 	1.3154 	-1.4840 	0.1209 	0.2517 	-0.1556 	0.5342 	0.0887 	0.0005 	0.2361 	0.0376 	0.0446 	0.4798 	0.2167 	1.3649 	0.2947 	-0.0845 	-0.1758
    -0.1102 	0.0105 	0.0204 	-0.1029 	-0.3630 	0.2040 	0.3056 	-0.3025 	-0.0343 	-0.3911 	0.0337 	-0.2712 	2.4644 	0.0040 	0.1385 	0.0080 	1.0362 	0.0656 	-0.0391 	-0.0033 	-0.0935 	-0.0452 	0.0270 	-0.6856 	0.0788 	-0.0883 	1.0383 	0.1679 	-0.3870 	-0.1081 	-0.2849 	-0.1901 	2.4335 	0.0007 	0.0034 	-2.4142 	0.4646 	-0.0759 	-0.0728 	-0.0472 	-0.3909 	-0.1001 	-0.1036 	-0.9859 	-0.1342 	0.2976
    0.8787 	0.5585 	-0.4736 	0.0537 	1.1293 	-0.8658 	-0.9279 	-0.4099 	0.8237 	-1.2540 	-1.1691 	-0.0943 	-4.7714 	0.0217 	0.2712 	-0.3589 	1.2617 	-0.1453 	1.6922 	0.5460 	0.6359 	1.3646 	0.8989 	-0.8075 	-0.1945 	-0.4628 	0.3949 	-0.4714 	1.4804 	0.3212 	-1.5707 	-0.8395 	-4.8443 	-0.4762 	1.1938 	2.1460 	1.3934 	0.2070 	0.2652 	0.0085 	1.4891 	0.6407 	-3.8255 	-0.2923 	-0.0291 	-0.8951
    -0.0028 	0.0259 	0.1073 	-0.0013 	0.0516 	0.0025 	1.2051 	-0.0434 	-0.0006 	0.2090 	0.0651 	0.0408 	0.0643 	-0.0078 	0.0177 	-0.0105 	0.0278 	-0.4107 	-0.0356 	-0.1594 	0.0128 	0.1734 	0.0131 	0.1773 	-0.0017 	0.0051 	0.0792 	-2.1374 	-0.2608 	-0.0720 	-0.0801 	-0.0083 	0.0658 	0.1423 	-0.0827 	-0.1709 	-0.0134 	-0.0288 	-0.0037 	-0.0047 	-0.2604 	-0.0388 	-0.1997 	-0.0722 	0.0089 	1.2269
    0.0682 	-0.0095 	-0.0443 	-0.0508 	-0.0379 	0.0380 	-0.1282 	0.0910 	-0.0308 	0.2018 	0.0953 	-0.0125 	-3.7289 	-0.0236 	-0.0288 	0.0127 	-0.0849 	-0.0560 	1.2303 	0.0680 	-0.0382 	-0.0701 	-0.0201 	-0.1064 	0.0115 	-0.0208 	-0.1161 	-0.1110 	-0.0135 	-0.0062 	0.0505 	-0.0281 	-3.5381 	-0.0489 	-0.0490 	13.5074 	-0.0045 	-0.0322 	-0.0125 	0.0067 	-0.0141 	-0.0282 	-1.2156 	0.1089 	-0.0062 	-0.1217
    0.4110 	0.0610 	-0.1370 	0.4985 	0.2744 	-0.5690 	0.8183 	0.2060 	-0.6654 	0.9846 	-0.6223 	0.5422 	1.1609 	0.0972 	-0.3607 	0.0000 	-1.2742 	-0.3790 	-2.5552 	0.1931 	-0.0472 	-1.0193 	-0.0341 	-1.6458 	0.0041 	0.2338 	-0.7083 	-0.0538 	0.3315 	0.0388 	1.2277 	-0.2138 	0.8810 	-0.1671 	0.6858 	-0.3687 	-0.0200 	-0.1801 	-0.1371 	0.3944 	0.3325 	-0.2456 	3.6249 	0.7770 	-0.1091 	0.7421
    -0.2400 	0.1942 	0.1498 	0.2797 	-0.2697 	0.5155 	0.2125 	-0.3340 	-0.3004 	0.1113 	0.3796 	-0.3547 	1.9289 	-0.0322 	0.0287 	0.0417 	0.2885 	0.0964 	-1.2378 	-0.0951 	0.0904 	0.1685 	0.0019 	-0.4516 	-0.0313 	-0.0471 	0.1643 	-0.1087 	-0.2927 	-0.1623 	0.0278 	-0.2330 	1.9404 	0.1426 	-0.4558 	-4.2085 	0.2288 	0.1727 	-0.0338 	0.0602 	-0.2940 	0.3488 	0.8132 	-0.1665 	0.0062 	0.2425
    -0.1910 	0.3759 	0.6288 	0.3641 	-1.1764 	0.3053 	-0.0223 	0.4688 	0.2598 	-0.3355 	0.1775 	-0.2498 	-1.9334 	-0.1122 	-0.1103 	0.2702 	-0.3682 	-0.7359 	2.4339 	-0.7674 	0.1126 	0.1234 	-0.7814 	0.4568 	0.0202 	0.1420 	-0.3756 	-0.6278 	-0.7478 	-0.8245 	0.2348 	-0.6640 	-1.7224 	0.7058 	-0.1793 	1.8944 	-1.0878 	-0.0557 	-0.1635 	0.0750 	-0.7640 	-0.2868 	1.2126 	0.3122 	-0.0545 	-0.0996
    -0.1060 	0.1038 	-0.0989 	-0.4080 	-0.0375 	-0.0538 	-0.3949 	0.5194 	0.4228 	-0.2340 	0.0420 	0.1725 	-0.2722 	0.0644 	0.1614 	-0.0843 	0.5400 	-0.1979 	-4.3067 	0.0652 	0.0607 	-0.1961 	0.1227 	1.3429 	-0.0263 	0.1709 	0.3716 	-0.4379 	0.1670 	0.0893 	0.2388 	-0.0361 	-0.2050 	-0.0648 	0.0427 	3.3691 	-0.1997 	0.2319 	-0.1624 	0.2336 	0.1692 	0.3593 	0.9147 	-0.5078 	-0.0138 	-0.3841
    -0.0061 	-0.0747 	0.1461 	0.0179 	-0.4363 	0.0259 	0.2925 	0.1027 	-0.0160 	-0.4820 	0.0334 	0.9778 	-0.0291 	0.0145 	-0.0522 	-0.0332 	-0.0100 	-0.0072 	-0.1400 	-0.5519 	-0.0536 	-0.0698 	0.0721 	-0.0239 	-0.0024 	-0.0395 	0.0160 	0.3234 	-4.0972 	0.0634 	0.0190 	-0.0326 	-0.0277 	0.4284 	-0.0423 	-0.0049 	-0.0156 	1.4747 	0.0187 	0.0082 	-4.1607 	1.4513 	0.0146 	-0.0154 	0.0110 	0.3650
    1.0749 	0.2899 	0.1950 	-0.2124 	1.3843 	-0.2648 	-2.2114 	-0.5015 	-0.2865 	-1.3805 	-0.6211 	0.1042 	-2.3885 	0.0709 	-0.0283 	0.1517 	0.6242 	0.0248 	0.6876 	-0.0291 	0.0280 	0.4003 	0.0886 	-0.0429 	-0.0659 	-0.0402 	-0.1461 	-0.0180 	-0.5482 	-1.7342 	0.4409 	-0.2053 	-2.4068 	0.1144 	0.4874 	7.0374 	-0.2055 	0.4046 	-0.1976 	-0.0955 	-0.5403 	0.4724 	-1.0821 	0.2564 	-0.0920 	-2.2446
    -0.1205 	-0.1181 	-1.7070 	0.1321 	3.5845 	-0.1911 	-0.9032 	1.5186 	-0.0793 	1.7291 	-0.1115 	1.4695 	-1.1535 	0.1607 	-0.0931 	-0.0255 	0.4385 	0.2070 	1.1325 	1.9210 	0.1312 	-0.0024 	0.2434 	-0.8155 	-0.3253 	-0.0518 	0.9527 	-0.5841 	5.6909 	2.0613 	1.0203 	0.1653 	-1.1410 	-1.8436 	0.1649 	-0.1996 	0.7629 	-0.8538 	-0.1967 	0.5409 	5.7235 	-1.1466 	-1.8293 	-1.0820 	0.3703 	-1.0721
    0.0451 	-0.0622 	1.1578 	0.1830 	-3.0886 	0.1238 	0.3850 	-0.5832 	-0.1695 	-0.0844 	0.0691 	-1.7759 	-0.2197 	-0.1003 	0.0552 	-0.0026 	0.0881 	0.1856 	0.5249 	-0.9844 	-0.0045 	-0.1074 	-0.4048 	-0.4190 	0.0283 	0.0030 	0.0858 	0.5580 	-3.0577 	-0.3580 	-0.2561 	-0.1109 	-0.1649 	1.0561 	-0.0696 	1.1465 	-0.2461 	0.0500 	-0.1063 	-0.0597 	-3.0681 	-0.0662 	0.1539 	-0.0532 	0.0222 	0.3764
    -0.1344 	-0.8267 	-1.2418 	-0.4776 	0.4289 	0.1780 	0.9163 	0.9715 	1.0038 	3.0538 	-0.2584 	1.6241 	-0.8078 	0.1231 	-0.2168 	0.2857 	0.4799 	-0.6432 	5.3984 	1.5687 	-0.7681 	-0.6398 	-0.5192 	1.0873 	-0.0526 	0.2425 	1.6060 	-0.7261 	3.8561 	1.1957 	1.9598 	-0.0005 	-0.6255 	-1.4791 	0.2708 	-0.2116 	0.4958 	-1.8605 	-0.1926 	-0.0341 	3.8514 	-3.0339 	0.6141 	-1.6940 	0.1441 	0.6591
    0.1014 	-0.1569 	-0.1989 	-0.1818 	4.1259 	-0.1222 	-0.8031 	-0.2342 	0.0989 	-0.3507 	-0.2238 	0.3892 	0.0764 	0.0400 	0.0840 	0.1000 	0.2420 	-0.0018 	-0.5207 	0.2087 	-0.0598 	0.8082 	-0.0889 	-0.3378 	-0.0290 	0.0800 	-0.2320 	-0.0769 	0.6187 	1.3667 	0.0258 	0.1680 	0.0590 	-0.2174 	0.2406 	0.0779 	0.1621 	0.1155 	-0.0048 	0.0210 	0.6246 	0.0359 	-0.0188 	0.2187 	0.0266 	-0.8205
    -0.8928 	0.1711 	0.4152 	0.0012 	-2.4459 	0.8866 	-1.4636 	-1.1705 	0.3357 	-0.8602 	0.8604 	-1.2924 	4.6374 	-0.1148 	0.0881 	-0.1215 	-0.2176 	-0.7978 	-0.2201 	-0.1989 	-0.1910 	0.4313 	0.0354 	-0.8658 	0.1503 	-0.5627 	-0.7595 	-2.7503 	-1.9449 	-1.1028 	-1.4079 	-0.4894 	4.4866 	0.3697 	-0.7860 	-6.7391 	-0.1294 	0.4109 	-0.3755 	1.2337 	-1.9514 	1.1923 	-0.3997 	0.8883 	-0.4005 	-1.4284
    1.9608 	-1.5754 	-0.8446 	0.1529 	1.3046 	-0.4667 	1.6160 	1.6683 	-0.1890 	4.2293 	-0.8800 	1.3339 	-1.8724 	-0.0930 	0.6042 	0.7643 	1.0823 	-0.1798 	2.8593 	1.6275 	0.1630 	-0.6968 	0.4304 	-0.3152 	-0.1943 	0.3403 	-0.8283 	-0.0544 	3.0778 	-2.6355 	-2.1097 	-0.5323 	-1.8993 	-1.1789 	0.5229 	6.7502 	-0.0633 	-1.9215 	0.1766 	-0.6767 	3.0243 	-2.1749 	-4.6436 	0.9738 	0.0700 	1.5282
    0.6215 	-0.2310 	-1.7312 	-1.8454 	-0.5862 	-0.1596 	-0.5429 	-1.3439 	2.4627 	-1.2901 	-0.8993 	0.2697 	-1.1143 	-0.2236 	-0.1214 	0.2226 	-0.1653 	1.0342 	6.6356 	1.5091 	-0.4254 	0.2881 	-1.3650 	2.4885 	0.1380 	0.4198 	0.7460 	-1.8393 	4.7206 	-0.1069 	0.0754 	0.1176 	-1.0867 	-1.6598 	0.9797 	5.1960 	-2.1670 	-1.0217 	0.0856 	-1.8065 	4.6792 	-1.1026 	1.1936 	-0.6775 	-0.1844 	-0.6259
    0.0149 	-0.1236 	1.3437 	0.0277 	-1.3723 	0.1320 	0.0140 	-0.3261 	-0.0257 	-0.0524 	-0.0599 	-1.8823 	-0.0350 	-0.0266 	0.0536 	-0.0236 	-0.0857 	0.0723 	-0.2974 	-1.3174 	-0.1116 	0.0188 	-0.0071 	-0.0524 	0.0419 	0.0384 	0.0749 	-0.1338 	-5.7391 	-1.3258 	-0.0766 	-0.0478 	-0.0179 	1.3680 	0.0574 	0.1403 	0.1145 	0.9053 	-0.0657 	-0.0078 	-5.7781 	0.4413 	-0.0462 	-0.0722 	-0.0048 	0.0012
    0.5439 	0.0389 	0.0274 	-0.7910 	0.8723 	-0.1666 	1.8009 	-0.3555 	0.4237 	-0.7112 	-0.5182 	0.6337 	-2.2048 	-0.0152 	0.5348 	0.2822 	1.6113 	-0.0116 	0.3198 	0.0121 	0.0645 	1.0958 	0.3909 	-2.2098 	-0.0609 	0.0566 	-0.6905 	-0.3120 	0.0687 	0.2004 	-0.6169 	0.0432 	-2.1056 	0.0413 	0.5152 	1.7307 	0.2566 	0.0539 	-0.1956 	-0.0941 	0.0787 	-0.0218 	2.6718 	0.5235 	-0.0261 	1.8211
    0.1031 	-0.3863 	-0.4342 	-0.1577 	8.2504 	-0.2228 	-0.9411 	-1.8951 	0.0922 	-1.5106 	-0.3629 	0.1216 	0.2715 	0.0980 	0.2202 	0.1825 	0.1073 	0.1397 	-0.3453 	0.3438 	-0.1188 	1.3659 	-0.1909 	-0.5604 	0.0098 	0.2387 	-0.2886 	0.0352 	2.3501 	1.8686 	-0.0681 	0.7415 	0.2293 	-0.4559 	0.4001 	-0.2624 	0.4502 	-0.4964 	0.0497 	0.1362 	2.3775 	-0.8875 	0.1504 	0.2565 	-0.0295 	-0.9809
    0.1642 	-0.2170 	1.2641 	0.1616 	-1.6950 	-0.0524 	0.6737 	-0.6832 	0.0134 	-0.3425 	-0.0630 	-1.2456 	-0.2709 	-0.1375 	0.1300 	-0.0394 	0.3643 	-0.2019 	0.0632 	-1.1954 	-0.1283 	-0.1333 	-0.3628 	-0.0742 	0.1345 	0.1644 	0.6039 	-0.0546 	-4.3132 	-0.6969 	-0.4826 	0.0513 	-0.2403 	1.2346 	0.0596 	1.3492 	-0.1956 	0.1698 	0.0417 	0.0415 	-4.3451 	0.1662 	-0.0423 	-0.5536 	0.0155 	0.6502
    -0.4105 	-0.0370 	1.1675 	0.7881 	-10.9359 	0.2334 	-0.7691 	0.4377 	-0.9569 	2.8230 	-0.0287 	-0.8306 	3.0526 	-0.1859 	-0.5955 	-0.0173 	-1.0726 	-0.2628 	-2.2974 	-0.7016 	-0.1209 	-0.2851 	-0.2455 	-0.8820 	0.0396 	-0.5843 	-0.5558 	-0.7189 	-5.2502 	1.3607 	0.5549 	-0.3904 	3.0608 	0.9628 	0.1243 	-6.6342 	-0.6980 	0.5280 	0.2551 	0.6931 	-5.2779 	0.7386 	2.8308 	0.6229 	-0.0682 	-0.8109
    2.2076 	-1.7790 	-1.4126 	-1.1043 	-4.2279 	-1.2317 	1.3471 	0.6632 	1.1707 	2.8158 	-2.0187 	0.8182 	-6.3735 	-0.0451 	-0.5660 	-0.4228 	2.1559 	0.2310 	1.5927 	1.1131 	0.5430 	0.4818 	1.4776 	2.5146 	-0.5043 	-0.8864 	4.1106 	1.0492 	7.2402 	0.9693 	0.4218 	-0.3052 	-6.3384 	-1.3158 	2.1106 	19.2349 	-0.8273 	-2.2754 	-0.4694 	-0.2726 	7.2807 	-2.2816 	-4.4404 	-3.8465 	0.4015 	1.3161
    -0.9852 	-0.0820 	0.5539 	-0.3565 	-1.6745 	0.1706 	0.0046 	2.3471 	0.4133 	-0.3492 	0.8526 	-0.5379 	0.0256 	-0.3896 	-0.6490 	-0.2511 	-0.1804 	-0.6323 	3.3568 	-1.3481 	-0.0334 	-0.9892 	0.0937 	3.4056 	0.1889 	-0.3194 	3.1760 	0.3013 	1.4673 	-3.2319 	0.6362 	0.0263 	0.0272 	0.8031 	-0.6856 	3.3471 	-0.6059 	-0.3270 	0.4034 	0.5421 	1.4145 	0.2880 	-1.7403 	-2.9335 	0.0098 	0.2824
    0.1905 	0.3645 	0.6648 	0.2868 	0.1209 	-0.2777 	0.0636 	-0.6941 	-1.1040 	0.0598 	-0.1287 	-0.8793 	1.3015 	0.0077 	0.0058 	-0.0302 	-0.6803 	0.0781 	0.9623 	-0.5931 	0.1341 	0.1791 	-0.1733 	-0.8661 	0.0354 	-0.0530 	-0.8207 	-0.4422 	-1.8008 	0.0379 	-0.7574 	-0.1648 	1.2517 	0.6421 	0.0282 	-2.0811 	0.2343 	0.6440 	0.1116 	0.1321 	-1.7968 	0.9531 	-1.5783 	0.8896 	-0.0658 	0.1146
    0.4408 	1.7819 	-0.4961 	-1.3214 	-0.0150 	-1.9299 	-2.3499 	0.8754 	0.4661 	1.4065 	-0.8370 	1.2857 	-1.5119 	0.3058 	0.0305 	0.0614 	-1.8671 	0.1095 	4.4693 	0.5932 	0.9085 	0.0283 	0.3587 	-1.6944 	-0.5156 	0.0022 	0.1682 	0.5624 	-3.2124 	0.1781 	0.4289 	-3.8002 	-1.7249 	-0.4340 	1.0368 	-0.9057 	-2.0583 	1.5428 	-0.4129 	-0.4227 	-3.2255 	3.1463 	-4.1957 	-0.4888 	-0.0467 	-2.3113
    2.3594 	-0.3295 	-0.9545 	-0.0578 	1.6212 	-1.2493 	1.8048 	-0.7900 	0.1310 	-0.4381 	-1.4299 	0.0360 	-1.5256 	0.3443 	0.2659 	-0.1221 	1.8225 	0.1203 	-1.2341 	1.3646 	0.3770 	2.6068 	0.3743 	1.0132 	-0.1712 	0.2322 	0.8312 	-0.1051 	3.2686 	0.1042 	-1.7135 	0.3626 	-1.5174 	-1.1866 	1.2594 	-5.7512 	0.3295 	-0.2845 	-0.4331 	-1.1444 	3.2733 	-0.5245 	3.9622 	-0.6530 	0.0050 	1.6712
    0.4742 	1.1607 	2.2170 	0.3922 	-0.5650 	-1.4978 	1.1480 	-0.9085 	-0.0787 	-1.7270 	0.0765 	-1.2187 	-1.9479 	-0.2519 	-0.0447 	0.2775 	1.1394 	-0.1077 	2.4470 	-1.7858 	-0.3297 	-0.3693 	-0.2022 	-0.6009 	0.1019 	0.0497 	-0.6582 	-0.5262 	-6.3259 	-1.7051 	-0.5117 	-1.5366 	-1.9125 	2.0985 	-0.0842 	0.2219 	0.4590 	1.5479 	-0.0979 	0.4810 	-6.3477 	1.6670 	-0.7079 	0.7099 	-0.2370 	1.1940
    -0.5411 	-0.0120 	-1.0904 	-0.0452 	2.0767 	0.6740 	-1.3812 	2.9849 	0.0265 	-2.2005 	0.1806 	1.7989 	1.3274 	0.1327 	0.2443 	0.0202 	-0.1620 	1.8437 	0.8173 	0.1712 	0.0943 	-0.2393 	1.8643 	-3.9894 	0.0196 	0.3141 	-0.0546 	2.4298 	-0.2912 	-0.9241 	0.0016 	0.1373 	0.6247 	-0.6299 	-0.1545 	-0.8710 	-1.2733 	-0.0494 	-0.3070 	0.4557 	-0.3296 	-0.4015 	-4.1716 	0.0668 	-0.3184 	-1.2267
    ];
w3 = [
    1.2533 	-0.6531 	0.5335 	1.9561 	-0.0338 	1.6405 	-0.7694 	0.1048 	1.4814 	0.0376 	4.3118 	0.0573 	1.5323 	-2.3016 	1.2003 	-1.8864 	-0.1991 	5.1429 	0.6293 	-0.3932 	-1.2311 	-0.1289 	-0.4685 	-7.0864 	-6.9375 	1.4419 	2.3789 	-2.3263 	-1.3781 	-0.2786 	0.1142 	-3.6519 	-1.5296 	-0.8691 	3.6649 	0.0961 	-2.2437 	0.8143 	1.4127 	0.7172 	1.3702 	-0.8370 	-4.8289 	2.5248 	-3.5698 	0.7527
    ]';

b1 = [
    1.8587 	-0.6158 	-1.8479 	-6.9477 	-2.3695 	-1.9838 	-6.2129 	1.5043 	0.6258 	0.8978 	0.7652 	-1.1047 	2.4568 	-1.5663 	0.6818 	3.0060 	8.4034 	0.7187 	0.2990 	1.6105 	-1.8059 	1.0255 	1.1525 	0.2887 	1.6102 	-0.7432 	-4.6507 	0.2976 	0.0254 	-1.5669 	-4.5193 	0.8808 	5.5381 	1.8358 	-1.3834 	4.1132 	3.1653 	0.9202 	-7.9224 	23.0684 	5.8525 	-1.1689 	3.1226 	-3.2818 	3.5065 	-3.7376
    ];
b2 = [
    1.0587 	0.3787 	-1.4354 	-1.8585 	-5.7420 	0.1611 	-1.7868 	-0.2730 	-2.0841 	-2.5447 	-0.9317 	0.5335 	-1.8605 	1.4016 	-0.1398 	-0.5943 	0.7405 	-0.5873 	0.3389 	0.3472 	-0.3572 	0.3187 	0.1396 	-0.0183 	-0.1802 	1.2174 	-2.0840 	-1.3611 	-0.4876 	-0.0603 	-0.6001 	2.9583 	-2.2891 	-0.9664 	0.7163 	4.1430 	-0.0397 	4.6300 	-1.7790 	-1.7564 	-0.3790 	2.0640 	-0.9014 	1.7362 	0.3307 	-2.4885
    ];
b3 = 0.7518;

%% predict factor of safety using neural network
% ensure predictors are in vector form
[n_row,n_col] = size(c_gh);
n_data = n_row*n_col;
x_c_gh = reshape(c_gh,n_data,1);
x_tanPhi = reshape(tanPhi,n_data,1);
x_tanBeta = reshape(tanBeta,n_data,1);
x_D = reshape(D,n_data,1);
x_ru = reshape(ru,n_data,1);
x_kh = reshape(kh,n_data,1);

% normalize predictors (equation 4)
X_norm = 2*([x_c_gh,x_tanPhi,x_tanBeta,x_D,x_ru,x_kh]-repmat(X_min,[n_data,1]))./(repmat(X_max-X_min,[n_data,1]))-1;

% make prediction (equation 5)
Y1 = exp((2./(1+exp(-2*((2./(1+exp(-2*(X_norm*w1+repmat(b1,[n_data,1]))))-1)*w2+repmat(b2,[n_data,1]))))-1)*w3+b3);
Y1_min = zeros(size(Y1));
Y1_max = ones(size(Y1))*5;
Y1(Y1<Y1_min) = Y1_min(Y1<Y1_min);
Y1(Y1>Y1_max) = Y1_max(Y1>Y1_max);

%% predict standard deviation using polynomial (equation 10)
Y2 = -0.0061./(1+exp(62.659*(x_c_gh-0.185)))+0.0088;

%% make dimension of outputs consistent with that of inputs
FS = reshape(Y1,n_row,n_col);
sigma_FS = reshape(Y2,n_row,n_col);
